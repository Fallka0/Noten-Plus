<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="noten.Pages.DashboardPage"
             Title="Dashboard">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <Frame BackgroundColor="#007AFF"
       CornerRadius="16"
       Padding="24"
       HasShadow="True">
                <VerticalStackLayout Spacing="8">
                    <HorizontalStackLayout>
                        <Label Text="âŒ€ Gesamtdurchschnitt" 
                                FontSize="16" 
                                FontAttributes="Bold"
                                TextColor="White"
                                VerticalOptions="Center" 
                                HorizontalOptions="Center"
                               />
                   <Label x:Name="OverallAverageLabel" 
                   Text="â€”" 
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="White" 
                   Padding="20"
                   />
                    </HorizontalStackLayout>
                    <Label x:Name="OverallCountLabel"
               Text="Basierend auf 0 Noten"
               FontSize="12"
               TextColor="#B3D9FF" />
                </VerticalStackLayout>
            </Frame>


            <!-- Meine FÃ¤cher Section -->
            <Frame>
                <VerticalStackLayout Spacing="12">
                    <HorizontalStackLayout>
                        <Label Text="Meine FÃ¤cher" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="Black"
                               VerticalOptions="Center"
                               HorizontalOptions="Center"/>
                
                        <Button Text="Fach hinzufÃ¼gen" 
                                Clicked="OnAddSubjectClicked"
                                HorizontalOptions="Center" 
                                VerticalOptions="Center"
                                Padding="10"
                                TextColor="#ffffff"
                                BorderWidth="0"
                                Margin="15"/>
                    </HorizontalStackLayout>

                    <!-- Leerer State - wird angezeigt wenn keine FÃ¤cher -->
                    <StackLayout x:Name="EmptySubjectsView" 
                                 IsVisible="True" 
                                 HorizontalOptions="Center"
                                 VerticalOptions="Center"
                                 Spacing="16">
                        <Image Source="folder.png" 
                               WidthRequest="64" 
                               HeightRequest="64"
                               HorizontalOptions="Center"/>
                        <Label Text="Noch keine FÃ¤cher" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="Black" />
                        <Label Text="FÃ¼ge dein erstes Fach hinzu, um deine Noten zu verwalten" 
                               FontSize="14"
                               HorizontalOptions="Center"
                               HorizontalTextAlignment="Center"
                               TextColor="Gray" />
                        <!-- BUTTON KORRIGIEREN: OnAddSubjectClicked statt OnSubjectsClicked -->
                        <Button Text="Erstes Fach hinzufÃ¼gen" 
                                Clicked="OnAddSubjectClicked"  
                                HorizontalOptions="Center"
                                BackgroundColor="#007AFF"
                                TextColor="White"
                                CornerRadius="8"
                                Padding="20,12"/>
                    </StackLayout>

                    <!-- FÃ¤cherliste - wird angezeigt wenn FÃ¤cher vorhanden -->
                    <CollectionView x:Name="SubjectsCollection" 
                                    SelectionMode="Single"
                                    IsVisible="False">
                        <!-- In der DataTemplate der SubjectsCollection -->
<CollectionView.ItemTemplate>
    <DataTemplate x:DataType="x:String">
        <Frame Margin="0,4" 
               Padding="16,12"
               BackgroundColor="#F5F5F7"
               HasShadow="False"
               CornerRadius="8">
            <HorizontalStackLayout>
                <Label Text="{Binding}" 
                       VerticalOptions="Center" 
                       TextColor="Black"
                       FontSize="16"/>
                <Label Text="" 
                       VerticalOptions="Center"
                       HorizontalOptions="EndAndExpand"
                       TextColor="Gray"
                       FontSize="16"/>
                <!-- Optional: Delete Button -->
                <Button Text="âœ•" 
                        Clicked="OnRemoveSubjectClicked"
                        CommandParameter="{Binding}"
                        BackgroundColor="Transparent"
                        TextColor="#FF3B30"
                        FontSize="16"
                        WidthRequest="44"/>
            </HorizontalStackLayout>
        </Frame>
    </DataTemplate>
</CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- Schnellzugriff Buttons -->
            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto" ColumnSpacing="12">
                <Frame Grid.Column="0">
                    <VerticalStackLayout Spacing="8" 
                                         HorizontalOptions="Fill"
                                         VerticalOptions="Fill">
                        <Button x:Name="AddGradeButton" 
                                Text="Note hinzufÃ¼gen" 
                                Clicked="OnAddGradeClicked"
                                BackgroundColor="#44AFFD"
                                TextColor="White"
                                CornerRadius="8"
                                HeightRequest="120">
                            <Button.ImageSource>
                                <FontImageSource Glyph="+" 
                                                 FontFamily="MaterialIcons"
                                                 Color="White"
                                                 Size="32"/>
                            </Button.ImageSource>
                        </Button>
                    </VerticalStackLayout>
                </Frame>

                <Frame Grid.Column="1">
                    <VerticalStackLayout Spacing="8">
                        <Button Text="Analytics" 
                                Clicked="OnAnalyticsClicked"
                                BackgroundColor="#1a5dfc"
                                TextColor="White"
                                CornerRadius="8"
                                HeightRequest="120">
                            <Button.ImageSource>
                                <FontImageSource Glyph="ðŸ“Š" 
                                                 Color="White"
                                                 Size="24"/>
                            </Button.ImageSource>
                        </Button>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>